// g++ logProbIPNew.cpp helperFunctions.cpp uniformMonteCarloIntegration.cpp pdfSamplingMonteCarloIntegration.cpp cMain.cpp -I/usr/local/include -L/usr/local/lib -lgsl -lgslcblas -O3 -std=c++11

#include "logProbIPNew.h"

using namespace std;


int main() {
    

    personClass x_1(1,nullptr,nullptr,true,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({}),false);
    personClass x_2(2,nullptr,nullptr,true,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({}),false);
    personClass x_23(23,nullptr,nullptr,true,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({}),false);
    personClass x_24(24,nullptr,nullptr,true,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({}),false);
    personClass x__1(-1,nullptr,nullptr,true,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({}),false);
    personClass x__4(-4,nullptr,nullptr,true,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({}),false);
    personClass x__7(-7,nullptr,nullptr,true,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({}),false);
    personClass x__10(-10,nullptr,nullptr,true,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({}),false);
    personClass x__13(-13,nullptr,nullptr,true,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({}),false);
    personClass x__16(-16,nullptr,nullptr,true,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({}),false);
    personClass x__22(-22,nullptr,nullptr,true,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({}),false);
    personClass x__60(-60,nullptr,nullptr,true,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({}),false);

    personClass x_3(3,&x_1,&x_2,false,1.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),true);
    personClass x_4(4,&x_1,&x_2,false,1.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),true);
    personClass x_5(5,&x_1,&x_2,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_6(6,&x_1,&x_2,false,1.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),true);
    personClass x_7(7,&x_23,&x_24,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_8(8,&x_3,&x__1,false,1.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),true);
    personClass x_9(9,&x_3,&x__1,false,1.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),true);
    personClass x_10(10,&x_4,&x__4,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_12(12,&x_6,&x_7,false,1.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),true);
    personClass x_13(13,&x_6,&x_7,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_15(15,&x_8,&x__7,false,1.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),true);
    personClass x_16(16,&x_8,&x__7,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_17(17,&x_9,&x__10,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_18(18,&x_12,&x__13,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_19(19,&x_12,&x__13,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_20(20,&x_19,&x__16,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_25(25,&x_23,&x_24,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_26(26,&x_25,&x__22,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_229(229,&x_6,&x_7,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_230(230,&x_229,&x__60,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);
    personClass x_231(231,&x_229,&x__60,false,0.000000,0.500000,0.000000,1,3,4,vector<double>(4),false,vector<vector<vector<double>>>({{{1.000000,0.500000,0.500000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.500000,0.250000,0.250000,0.000000},{0.500000,0.250000,0.250000,0.000000},{1.000000,0.500000,0.500000,0.000000}},{{0.000000,0.500000,0.500000,1.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.000000,0.000000,0.000000}},{{0.000000,0.000000,0.000000,0.000000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.250000,0.250000,0.500000},{0.000000,0.500000,0.500000,1.000000}}}),false);



    pedigreeClass2 pedigree;
    
    pedigree.roots=vector<personClass*>({&x_1,&x_2,&x_23,&x_24,&x__1,&x__4,&x__7,&x__10,&x__13,&x__16,&x__22,&x__60});
    pedigree.allPeople=vector<personClass*>({&x_1,&x_2,&x_23,&x_24,&x__1,&x__4,&x__7,&x__10,&x__13,&x__16,&x__22,&x__60,&x_3,&x_4,&x_5,&x_6,&x_7,&x_8,&x_9,&x_10,&x_12,&x_13,&x_15,&x_16,&x_17,&x_18,&x_19,&x_20,&x_25,&x_26,&x_229,&x_230,&x_231});

    
    long numbCalls = 730000;
    bool printIterations = true;
    int numbToPrint = numbCalls*0.01;
    bool printPeople = false;
    bool useNewDist = true;
    double K = 10.0;
    bool useLeak = true;
    double leakProb = 0.2;
    double leakDecay = 0.5;
    bool useMH = true;
    

    pedigree.monteCarlo(numbCalls,printIterations,numbToPrint,printPeople,useNewDist,K,useLeak,leakProb,leakDecay,useMH);

    return 1;
}


